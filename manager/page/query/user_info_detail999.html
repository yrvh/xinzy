<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<script src="../../../js/mui.min.js"></script>
	<link rel="stylesheet" href="../../../css/mui.min.css">
	<script src="../../../js/mescroll.min.js"></script>
	<link rel="stylesheet" href="../../../css/mescroll.min.css">
	<title>查询--用户查询--详情页面</title>
	
	<style type="text/css">
		body { margin: 0; padding: 0; font-size: 16px; color: #333333; }
		
		header { position: fixed;
			top: 0; left: 0; text-align: center; width: 100%;
			height: 44px; line-height: 44px; background-color: white;
			box-shadow: 0 2px 2px 0 rgba(231, 231, 231, 1);
			font-weight: bold; font-size: 16px; z-index: 99; }
		
		.back { width: 20px; height: 20px; position: absolute; top: 12px; left: 5px; color: #7EB6FF; }		
		
		.the-place { width: 100%; height: 44px; }
		
		.com-status { width: 100%; line-height: 44px; background-color: #fff; margin: 20px 0; padding: 0 15px;}
		
		ul { list-style: none; padding: 0 15px; margin-bottom: 20px; background-color: #fff;}
		
		li { border-bottom: 1px solid #ddd; display: flex; justify-content: space-between; align-items: center; width: 100%; height: 46px; margin-bottom: 2px; line-height: 46px; box-sizing: border-box; }
		
		li>div { display: flex; align-items: center; justify-content: space-between;}
		
		li img { width: 25px; height: 25px; }
		
		li>div>span { color: rgb(153, 153, 153); }
		
		.info-title { line-height: 50px; font-weight: 800; font-size: 17px;}
		
		.com-license,.corp-email,.account-num,.comfree-contract,
		.per-IDcardImg,.account-num,.income-scope,.taxes-type,.taxes-added,
		.taxes-income,.com-range,.com-license,.account-num{border: none !important;}
		
		.company-info,.personal,.individual,.income-info { display: none; }
	</style>
</head>

<body>
	<header>
			<img class="back" src="../../../img/back_black.png" alt=""> 公司信息
	</header>
	<div class="the-place"></div>
	<div class="com-status">注册状态: <span class="status-li">待主管审核</span></div>
	
	<!-- 公司基本信息 -->
	<div class="company-info">
		<ul class="com-info">
			<div class="info-title">公司基本信息</div>
			<li class="com-logo">
					<span>公司商标</span>
					<div>
							<span class="com-logo-li"></span>
							<img src="../../../img/next.png" alt="">
					</div>
			</li>
			<li class="com-creditcode">
					<span>统一社会信用代码</span>
					<div>
							<span class="com-creditcode-li"></span>
					</div>
			</li>
			<li class="com-name">
					<span>单位名称</span>
					<div>
							<span class="com-name-li"></span>
					</div>
			</li>
			<li class="com-acronym">
					<span>单位名称缩写</span>
					<div>
							<span class="com-acronym-li"></span>
							<img src="../../../img/next.png" alt="">
					</div>
			</li>
			<li class="com-fund">
					<span>注册资本</span>
					<div>
							<span class="com-fund-li"></span>
					</div>
			</li>
			<li class="com-type">
					<span>单位类型</span>
					<div>
							<span class="com-type-li"></span>
					</div>
			</li>
			<li class="com-address">
					<span>住所</span>
					<div>
							<span class="com-address-li"></span>
							<img src="../../../img/next.png" alt="">
					</div>
			</li>
			<li class="com-detailaddr">
					<span>详细地址</span>
					<div>
							<span class="com-detailaddr-li"></span>
							<img src="../../../img/next.png" alt="">
					</div>
			</li>
			<li class="com-fixedtel">
					<span>固定电话</span>
					<div>
							<span class="com-fixedtel-li"></span>
					</div>
			</li>
			<li class="com-regidate">
					<span>成立日期</span>
					<div>
							<span class="com-regidate-li"></span>
					</div>
			</li>
			<li class="com-deadline">
					<span>经营期限</span>
					<div>
							<span class="com-deadline-li"></span>
					</div>
			</li>
			<li class="com-range">
					<span>业务范围</span>
					<div>
							<span class="com-range-li"></span>
							<img src="../../../img/next.png" alt="">
					</div>
			</li>
			<li class="com-major">
					<span>主营业务</span>
					<div>
							<span class="com-major-li"></span>
							<img src="../../../img/next.png" alt="">
					</div>
			</li>
			<li class="com-organ">
					<span>公司登记机关</span>
					<div>
							<span class="com-organ-li"></span>
					</div>
			</li>
			<li class="com-issue">
					<span>发证日期</span>
					<div>
							<span class="com-issue-li"></span>
					</div>
			</li>
			<li class="com-license">
					<span>营业执照</span>
					<div>
							<span class="com-license-li"></span>
							<img src="../../../img/next.png" alt="">
					</div>
			</li>
		</ul>
		
		<ul class="corp-info">
			<div class="info-title">法定代表人信息</div>
			<li class="corp-name">
					<span>法人代表姓名</span>
					<div>
							<span class="corp-name-li"></span>
					</div>
			</li>
			<li class="corp-type">
					<span>证件类型</span>
					<div>
							<span class="corp-type-li"></span>
							<img src="../../../img/next.png" alt="">
					</div>
			</li>
			<li class="corp-number">
					<span>证件号码</span>
					<div>
							<span class="corp-number-li"></span>
					</div>
			</li>
			<li class="corp-photo">
					<span>证件照片</span>
					<div>
							<span class="corp-photo-li"></span>
							<img src="../../../img/next.png" alt="">
					</div>
			</li>
			<li class="corp-tel">
					<span>手机号码</span>
					<div>
							<span class="corp-tel-li"></span>
					</div>
			</li>
			<li class="corp-email">
					<span>电子邮箱</span>
					<div>
							<span class="corp-email-li"></span>
					</div>
			</li>
		</ul>
		
		<ul class="account-info">
			<div class="info-title">公司账户信息</div>
			<li class="account-bank">
					<span>开户行</span>
					<div>
							<span class="account-bank-li"></span>
					</div>
			</li>
			<li class="account-name">
					<span>开户名</span>
					<div>
							<span class="account-name-li"></span>
					</div>
			</li>
			<li class="account-num">
					<span>账号</span>
					<div>
							<span class="account-num-li"></span>
					</div>
			</li>
		</ul>
		
		<ul class="com-free">
			<li class="comfree-contract">
					<span>与业者的协议模板</span>
					<div>
							<span class="comfree-contract-li"></span>
					</div>
			</li>
		</ul>
	</div>
	
	<!-- 个人信息 -->
	<div class="personal">
		<ul class="personal_info">
			<div class="info-title">个人信息</div>
			<li class="per-name">
				<span>姓名</span>
				<div>
					<span class="per-name-li"></span>
				</div>
			</li>
			<li class="per-tel">
				<span>手机号码</span>
				<div>
					<span class="per-tel-li"></span>
				</div>
			</li>
			<li class="per-email">
				<span>电子邮箱</span>
				<div>
					<span class="per-email-li"></span>
				</div>
			</li>
			<li class="per-IDcard">
				<span>身份证号码</span>
				<div>
					<span class="per-IDcard-li"></span>
				</div>
			</li>
			<li class="per-IDcardImg">
				<span>证件照片</span>
				<div>
					<span class="per-IDcardImg-li"></span>
					<img src="../../../img/next.png" alt="">
				</div>
			</li>
		</ul>
		
		<ul class="account-info">
			<div class="info-title">个人账户信息</div>
			<li class="account-bank">
				<span>开户机构</span>
				<div>
					<span class="account-bank-li"></span>
				</div>
			</li>
			<li class="account-name">
				<span>开户名</span>
				<div>
					<span class="account-name-li"></span>
				</div>
			</li>
			<li class="account-num">
				<span>账号</span>
				<div>
					<span class="account-num-li"></span>
				</div>
			</li>
		</ul>
		
		<ul class="income-info">
			<div class="info-title">收入信息</div>
			<li class="income-scope">
				<span>收入范围(元)</span>
				<div>
					<span class="income-scope-li"></span>
				</div>
			</li>
		</ul>
		
		<ul class="taxes-info">
			<div class="info-title">纳税信息</div>
			<li class="taxes-type">
				<span>行业类型</span>
				<div>
					<span class="taxes-type-li"></span>
				</div>
			</li>
			
			<div class="added row">增值税 (按月)</div>
			<li class="taxes-added">
				<span>核定定额 (元)</span>
				<div>
					<span class="taxes-added-li"></span>
				</div>
			</li>
			
			<div class="income row">个人所得税</div>
			<li class="taxes-income">
				<span>核定定额(元)</span>
				<div>
					<span class="taxes-income-li"></span>
				</div>
			</li>
		</ul>
	</div>
	
	<!-- 个体工商户信息 -->
	<div class="individual">
		<ul class="com-info">
			<div class="info-title">个体工商户信息</div>
			<li class="com-creditcode">
				<span>统一社会信用代码</span>
				<div>
					<span class="com-creditcode-li"></span>
				</div>
			</li>
			<li class="com-operator">
				<span>经营者</span>
				<div>
					<span class="com-operator-li"></span>
				</div>
			</li>
			<li class="com-name">
				<span>商户名称</span>
				<div>
					<span class="com-name-li"></span>
				</div>
			</li>
			<li class="com-type">
				<span>类型</span>
				<div>
					<span class="com-type-li"></span>
				</div>
			</li>
			<li class="com-date">
				<span>注册日期</span>
				<div>
					<span class="com-date-li"></span>
				</div>
			</li>
			<li class="com-range">
				<span>经营范围</span>
				<div>
					<span class="com-range-li"></span>
					<img src="../../../img/next.png" alt="">
				</div>
			</li>
		</ul>
		
		<ul>
			<li class="com-address">
				<span>登记地址</span>
				<div>
					<span class="com-address-li"></span>
				</div>
			</li>
			<li class="com-organ">
				<span>登记机关</span>
				<div>
					<span class="com-organ-li"></span>
				</div>
			</li>
			<li class="com-issue">
				<span>发证日期</span>
				<div>
					<span class="com-issue-li"></span>
				</div>
			</li>
			<li class="com-license">
				<span>营业执照</span>
				<div>
					<span class="com-license-li"></span>
					<img src="../../../img/next.png" alt="">
				</div>
			</li>
		</ul>
		
		<ul class="account-info">
			<div class="info-title">公司账户信息</div>
			<li class="account-bank">
				<span>开户行</span>
				<div>
					<span class="account-bank-li"></span>
				</div>
			</li>
			<li class="account-name">
				<span>开户名</span>
				<div>
					<span class="account-name-li"></span>
				</div>
			</li>
			<li class="account-num">
				<span>账号</span>
				<div>
					<span class="account-num-li"></span>
				</div>
			</li>
		</ul>
	</div>
	
</body>
<script src="../../../js/jquery-3.3.1.js"></script>
<script src="../../../js/urlDns.js"></script>
<script src="../../../js/layer/layer.js"></script>

<script type="text/javascript">
	var pass_app = localStorage.getItem("pass_app");
	var tel_app = localStorage.getItem("tel_app");
	var code_app = localStorage.getItem("code_app");
	
	// 返回
	$(".back").click(() => {
	    mui.back();
			sessionStorage.removeItem("detailId")
			sessionStorage.removeItem("detailType")
	});
	
	// 获取用户id和用户类型
	let detailId = sessionStorage.getItem("detailId")
	let detailType = sessionStorage.getItem("detailType")
	
	
	let urlDetail = ''
	// 控制显示哪个页面 1业者    2单位  11或作伙伴
	if(detailType==1){
		// 业者的详情
		$(".company-info").css("display", "none");
		$(".personal").css("display", "block");
		// $(".individual").css("display", "block");
		urlDetail = '/control_app/ms/fr/yz/showUI'
		getDetail(urlDetail,detailId,detailType)
	}
	if(detailType==2){
		// 单位的详情
		$(".company-info").css("display", "block");
		$(".personal").css("display", "none");
		// $(".individual").css("display", "none");
		urlDetail = '/control_app/ms/fr/dw/showUI'
		getDetail(urlDetail,detailId,detailType)
	}
	if(detailType==11){
		// 合作伙伴的详情
		$(".company-info").css("display", "none");
		$(".personal").css("display", "block");
		// $(".individual").css("display", "block");
		urlDetail = '/control_app/ms/fr/yz/showUI'
		getDetail(urlDetail,detailId,detailType)
	}

	
	// 定义请求详情的函数
	function getDetail(url, id='',uType) {
		console.log(url)
		console.log(id)
		var index = layer.load(1, {
				// 数组中第一个参数是button的透明度
				// 第二个是背景颜色
				shade: [0.3, "white"]
		});
		var getData = $.ajax({
				url: urlDns + url,
				type: 'post',
				dataType: "json",
				timeout: 120000, //2分钟超时
				data: {
						"pass_app": pass_app,
						"tel_app": tel_app,
						"code_app": code_app,
						"id": id
				},
				//请求成功
				success: function(data) {
						console.log("响应了")
						console.log(JSON.stringify(data));
						layer.close(index);
						if (data.result == 0) {
								// 需要重新登录
								if (window.plus) {
										goToLogin("../../../page/register/login.html");
								} else {
										document.addEventListener('plusready', goToLogin, false);
								}
						} 
						else {
							renderPage(uType,data)
						}
				},
				error: function(XMLHttpRequest, textStatus, errorThrown) {
						layer.close(index);
						if (textStatus == 'timeout') {
								getData.abort();　
								alert("请求超时");
						}
						if (textStatus == 'error') {
								getData.abort();　
								alert("请求错误" + errorThrown);
						}
				}
		});
	}
	
	
	// 定义函数, 不同的角色, 渲染不同的页面
	function renderPage(uType,data) {
		// uType 用户类型1.业者  2.单位    11  合作伙伴,
		if(uType==1){
			
			$(".status-li").text(data.regState)
			$(".per-name-li").text(data.realname)
			$(".per-tel-li").text(data.tel)
			$(".per-email-li").text(data.email)
			$(".per-IDcard-li").text(data.idcard)
			$(".per-IDCardImg-li").text("证件照片")
			
			$(".account-bank-li").text(data.khh_sr)
			$(".account-name-li").text(data.kh_name_sr)
			$(".account-num-li").text(data.code_sr)
			// $(".income-scope-li").text(data.)
			// $(".taxes-type-li").text(data.)
			// $(".taxes-added-li").text(data.)
			// $(".taxes-income-li").text(data.)
		}
		
		
		if (data.icon != "/img/R.png") {
			console.log(data.icon)
			$(".logo").attr("src", data.icon);
		} 
		else {
				$(".logo").attr("src", "../../../img/com_default_Icon.png");
		}

	
	
		if (data.ishavelxr == 1) {
				// 启用了联系人
				$(".contacts").css("display", "block");
				// 法人信息
				console.log(data.realname_fr)
				$("#ceoName").text(data.realname_fr);
				$("#ceoCertifiType").text("身份证");
				$("#ceoNum").text(data.idcard_fr);
				$("#ceotTel").text(data.tel_fr);
				$("#ceoEmail").text(data.email_fr);
				// 联系人信息
				$("#contactsName").text(data.realname);
				$("#ceoCertifiType").text("身份证");
				$("#certificatesNum").text(data.idcard);
				$("#contactsTel").text(data.usertel);
				$("#contactsEmail").text(data.email);
		} 
		else {
				// 未启用联系人，没有联系人信息
				$(".contacts").css("display", "none");
				// 法人信息
				$("#ceoName").text(data.realname);
				$("#ceoCertifiType").text("身份证");
				$("#ceoNum").text(data.idcard);
				$("#ceotTel").text(data.usertel);
				$("#ceoEmail").text(data.email);
		}
	}
	
	
	
	// // 公司商标照片
	// $(".com_logo").click(() => {
	//     location.href = "./com_logo.html";
	// });
</script>
</html>
