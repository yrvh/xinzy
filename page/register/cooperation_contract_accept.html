<!DOCTYPE html>
<html lang="">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="../../js/mui.min.js"></script>
    <link rel="stylesheet" href="../../css/mui.min.css">
    <title>合作伙伴协议</title>
    <!-- 和接受服务单位的协议（接受服务单位也是商秘公司） -->
		
		<style type="text/css">
			html,
			body {
			    width: 100%;
			    /* height: 100%; */
			    margin: 0;
			    padding: 0;
			}
			
			header {
			    position: fixed;
			    top: 0;
			    left: 0;
			    width: 100%;
			    height: 44px;
			    background-color: white;
			    box-shadow: 0 2px 2px 0 rgba(231, 231, 231, 1);
			    text-align: center;
			    line-height: 44px;
			    font-weight: bold;
			}
			
			header>img {
			    position: absolute;
			    top: 12px;
			    left: 5px;
			    width: 20px;
			    height: 20px;
			}
			
			.title {
			    width: 100%;
			    height: 50px;
			    background-color: white;
			    margin-top: 65px;
			    line-height: 50px;
			    font-size: 20px;
			    font-weight: 700;
			    padding: 5px 15px;
			    padding-bottom: 60px;
			}
			
			.first,
			.second {
			    width: 100%;
			    height: 30px;
			    background-color: white;
			    padding: 0 15px;
			    padding-bottom: 40px;
			    font-size: 14px;
			}
			
			.serviceFeeBox,
			.serviceFeeBox_exceed {
			    width: 100%;
			    height: 50px;
			    background-color: white;
			    padding: 0 15px;
			    margin-top: 64px;
			    line-height: 50px;
			    font-size: 14px;
			}
			
			.serviceFeeBox_exceed {
			    margin: 0;
			}
			
			.cont {
			    width: 100vw;
			    word-wrap: break-word;
			    height: 100%;
			    background-color: white;
			    padding: 10px 15px;
			    margin-bottom: 70px;
			    overflow: hidden;
			}
			
			p {
			    margin: 0;
			}
			
			.btnBox {
			    bottom: 0;
			    left: 0;
			    display: flex;
			    width: 100%;
			    height: 50px;
			    background-color: white;
			    border-top: 1px solid #eeeeee;
			}
			
			.position {
			    position: fixed;
			}
			
			.refuse {
			    color: #7EB6FF;
			}
			
			.refuse,
			.agree {
			    width: calc((100% - 30px)/2);
			    height: 40px;
			    margin-top: 5px;
			    margin-left: 10px;
			    border-radius: 4px;
			    border: 1px solid rgb(204, 204, 204);
			    text-align: center;
			    line-height: 40px;
			}
			
			.agree {
			    color: white;
			    background-color: rgb(231, 231, 231);
			    border-color: white;
			}
			
			.black,
			.black2,
			.black3,
			.black4 {
			    width: 100%;
			    height: 100vh;
			    background-color: rgba(16, 16, 16, 0.1);
			    position: fixed;
			    top: 0;
			    left: 0;
			    z-index: 9;
			    display: none;
			}
			
			
			/* .black3 {
			    display: block;
			} */
			
			#jqmeter-container {
			    width: 270px;
			    margin: 0 auto;
			    margin-top: calc((100vh - 20px)/2);
			}
			
			.black>section,
			.black3>section {
			    position: relative;
			    width: 270px;
			    height: 144px;
			    border-radius: 13px;
			    background-color: white;
			    margin: 0 auto;
			    margin-top: calc((100vh - 144px)/2);
			}
			
			.cancel,
			.downLoad,
			.open,
			.close {
			    position: absolute;
			    bottom: 0;
			    width: 50%;
			    height: 45px;
			    text-align: center;
			    line-height: 45px;
			    border-top: 1px solid #e7e7e7;
			}
			
			.cancel,
			.close {
			    left: 0;
			    color: #666666;
			}
			
			.downLoad,
			.open {
			    right: 0;
			    color: #7EB6FF;
			    border-left: 1px solid #e7e7e7;
			}
			
			.openTips {
			    width: 100%;
			    height: 99px;
			    text-align: center;
			    line-height: 99px;
			    color: rgb(153, 153, 153);
			    font-size: 15px;
			}
			
			.tipTitle {
			    width: 100%;
			    padding-top: 15px;
			    color: #030303;
			    font-weight: 700;
			    text-align: center;
			}
			
			.tipCont {
			    font-size: 12px;
			    color: rgb(153, 153, 153);
			    padding: 0 35px;
			    text-align: center;
			    margin-top: 10px;
			}
			
			#serviceFee,
			#serviceFee_exceed {
			    width: 50px;
			    height: 25px;
			    margin: 0;
			    padding: 0;
			    color: #7EB6FF;
			    text-align: center;
			}
			
			.submit {
			    display: none;
			    width: calc(100% - 20px);
			    height: 40px;
			    border-radius: 4px;
			    background-color: #7EB6FF;
			    text-align: center;
			    line-height: 40px;
			    color: white;
			    margin: 5px 0 0 10px;
			}
			
			.tipBox {
			    position: absolute;
			    top: calc((100vh - 144px)/2);
			    left: calc((100% - 270px)/2);
			    width: 270px;
			    height: 144px;
			    background-color: white;
			    border-radius: 13px;
			    text-align: center;
			    padding: 35px 30px 0 30px;
			    font-size: 14px;
			    color: rgb(153, 153, 153);
			}
			
			.ok {
			    position: absolute;
			    bottom: 0;
			    left: 0;
			    width: 100%;
			    height: 45px;
			    text-align: center;
			    line-height: 45px;
			    color: #7EB6FF;
			    font-size: 16px;
			    border-top: 1px solid #e7e7e7
			}
		</style>
</head>

<body>
    <header>
        <img class="back" src="../../img/back_black.png" alt=""> 合作伙伴协议
    </header>
    <!-- <div class="title">关于*****的协议书</div> -->
    <!-- <div class="first">甲方：<span></span></div> -->
    <!-- <div class="second">乙方：<span></span></div> -->
    <!-- <div class="serviceFeeBox">业者收入6%以内服务费合作伙伴占比：<input id="serviceFee" type="text" value="10">%</div> -->
    <!-- <div class="serviceFeeBox_exceed">业者收入超出6%服务费合作伙伴占比：<input id="serviceFee_exceed" type="text" value="70">%</div> -->
    <div class="cont"></div>

    <div class="black">
        <section>
            <div class="tipTitle">授权委托协议书</div>
            <div class="tipCont">自行下载打印协议书，并必须本人签字，交给选定的商务秘书公司</div>
            <section class="cancel">取消</section>
            <section class="downLoad">下载</section>
        </section>
    </div>
    <div class="black2">
        <div id="jqmeter-container"></div>
    </div>
    <div class="black3">
        <section>
            <div class="openTips">下载完成，是否打开文件</div>
            <div class="close">完成</div>
            <div class="open">打开</div>

        </section>
    </div>
    <div class="black4">
        <div class="tipBox">
            <div class="reason">请重新修改服务费比例</div>
            <div class="ok">确定</div>
        </div>
    </div>
    <div class="btnBox position">
        <div class="submit">提交</div>
        <div class="refuse">拒绝</div>
        <div class="agree">同意</div>
    </div>
</body>
<script src="../../js/jquery-3.3.1.js"></script>
<script src="../../js/urlDns.js"></script>
<script src="../../js/layer/layer.js"></script>
<script src="../../js/jqmeter.min.js"></script>

<script type="text/javascript">
	mui.init();
	// 返回
	$(".back").click(() => {
	    // alert(111)
	    // history.back();
	    location.href = "./cooperation_com.html";
	});
	
	// 获取接受服务单位的id
	var comid = sessionStorage.getItem("comids");
	console.log(comid);
	
	// 协议ID，两个分配比例
	// var hhr_ms_id, hhr_ms_fpbili, hhr_ms_fpbili2;
	
	// 加载提示
	var index = layer.load(1, {
	    // 数组中第一个参数是button的透明度
	    // 第二个是背景颜色
	    shade: [0.3, "white"]
	});
	
	// 加载提示
	var index = layer.load(1, {
	    // 数组中第一个参数是button的透明度
	    // 第二个是背景颜色
	    shade: [0.3, "white"]
	});
	// 请求协议文本
	var ajaxPost = $.ajax({
	    url: urlDns + "/user_app/hhr/showXY",
	    type: 'post',
	    dataType: "json",
	    data: {
	        comid: comid
	    },
	    timeout: 120000, //2分钟超时
	    //请求成功
	    success: function(data) {
	        layer.close(index);
	        console.log(JSON.stringify(data))
	            // console.log(data.hhr_ms_fpbili2)
	            // console.log(data.hhr_ms_fpbili);
	
	        hhr_ms_id = data.hhr_ms_id;
	        // hhr_ms_fpbili = data.hhr_ms_fpbili;
	        // hhr_ms_fpbili2 = data.hhr_ms_fpbili2;
	        // $("#serviceFee").val(data.hhr_ms_fpbili);
	        // $("#serviceFee_exceed").val(data.hhr_ms_fpbili2);
	        $(".cont").html(data.hhr_ms_text);
	
	        // 当协议内容不超过一页时，直接允许同意
	        if ($(document.body).height() < $(window).height() - 155) {
	            // 减掉的290是除了$(".cont")以外其他元素的高度
	            $(".cont").css("height", "calc(100vh - 135px)");
	            $(".cont").css("margin-bottom", "0");
	            $(".agree").css({ "background-color": "#7EB6FF", }).on("click", function() {
	                // 储存分配比例
	                sessionStorage.setItem("hhr_ms_fpbili", hhr_ms_fpbili);
	                sessionStorage.setItem("hhr_ms_fpbili2", hhr_ms_fpbili2);
	                // hhr_ms_id 合作伙伴与商秘公司的协议id
	                sessionStorage.setItem("hhr_ms_id", hhr_ms_id);
	                location.href = "./cooperation_contract_com.html";
	
	            });
	        }
	    },
	    error: function(XMLHttpRequest, textStatus, errorThrown) {
	        layer.close(index);
	        if (textStatus == 'timeout') {
	            ajaxPost.abort();
	            alert("请求超时");
	        }
	        if (textStatus == 'error') {
	            ajaxPost.abort();
	            alert("请求错误" + errorThrown);
	        }
	    }
	});
	
	// 监听当用户滑动到底部才允许同意协议
	$(window).scroll(() => {
	    // 加1是因为有些手机的$(this).scrollTop()有零点几的偏差
	    if ($(window).scrollTop() + $(window).height() + 1 >= $(document).height()) {
	        $(".agree").css({ "background-color": "#7EB6FF", }).on("click", function() {
	            // 储存分配比例
	            // sessionStorage.setItem("hhr_ms_fpbili", hhr_ms_fpbili);
	            // sessionStorage.setItem("hhr_ms_fpbili2", hhr_ms_fpbili2);
	            // hhr_ms_id 合作伙伴与商秘公司的协议id
	            sessionStorage.setItem("hhr_ms_id", hhr_ms_id);
	            location.href = "./cooperation_contract_com.html";
	        });
	
	    }
	});
	
	// 拒绝按钮
	$(".refuse").click(() => {
	    history.back();
	});
</script>

</html>