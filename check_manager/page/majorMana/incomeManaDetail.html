<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<script src="../../../js/mui.min.js"></script>
	<link rel="stylesheet" href="../../../css/mui.min.css">
	<script src="../../../js/mescroll.min.js"></script>
	<link rel="stylesheet" href="../../../css/mescroll.min.css">
	<title>审核主管--收入管理--信息详情</title>
	
	<style type="text/css">
		body { margin: 0; padding: 0; font-size: 16px; color: #333333; background-color: #fafafa;}
		
		header { position: fixed;
			top: 0; left: 0; text-align: center; width: 100%;
			height: 44px; line-height: 44px; background-color: white;
			box-shadow: 0 2px 2px 0 rgba(231, 231, 231, 1);
			font-weight: bold; font-size: 16px; z-index: 99; }
		
		.back { width: 20px; height: 20px; position: absolute; top: 12px; left: 5px; color: #7EB6FF; }		
		
		.the-place { width: 100%; height: 44px; margin-bottom: 20px;}
		
		.com-status { width: 100%; line-height: 44px; background-color: #fff; margin: 20px 0; padding: 0 15px;}
		
		ul {margin: 0; list-style: none; padding: 0 15px; background-color: #fff;}
				
		li { border-bottom: 1px solid #ddd; display: flex; justify-content: space-between; align-items: center; width: 100%; height: 46px; margin-bottom: 2px; line-height: 46px; box-sizing: border-box; }
				
		li>div { display: flex; align-items: center; justify-content: space-between;}
		
		li img { width: 25px; height: 25px; }
		
		li>div>span { color: rgb(123, 123, 123); }
		
		ul>li:last-of-type {border: none !important;}
		.fwstyle { color: #0062CC; font-weight: 600;}
		
		.info-title { line-height: 50px; font-weight: 800; font-size: 17px;}
		.info-ul { margin: 20px 0; }
		.deal-ul{ margin-bottom: 60px;}
		
		.con-dialog {text-align: right; width: 200px; overflow: hidden; white-space: nowrap; text-overflow: ellipsis;}
		
		
		/* 展示退回 原因的容器 start*/
		.returnTitle,
		.returnCont {
			background-color: #fff;
		    display: none;
		    width: 100%;
		    font-size: 14px;
		    padding: 0 2.5%;
				line-height: 30px;
		}
		.returnCont {
			margin-bottom: 30px;
		}
		
		
		/* --------- 弹出平台协议的样式------  */
		.ctra-dialog {background-color: #FFF; display: none; position: fixed; width: 100%; height: 100vh; overflow-y: auto; left: 0; top: 0; z-index: 120;}
			
		.ctra-header {
				position: fixed;
				top: 0;
				left: 0;
				text-align: center;
				width: 100%;
				height: 44px;
				line-height: 44px;
				background-color: white;
				box-shadow: 0 2px 2px 0 rgba(231, 231, 231, 1);
				font-weight: bold;
				font-size: 16px;
		}
		
		.ctra-header>img {
				position: absolute;
				top: 12px;
				left: 5px;
				width: 20px;
				height: 20px;
		}
		p {margin: 0;}
		.itemContent {
				width: 100%;
				/* height: calc(100vh - 20px); */
				margin-top: 40px;
				padding: 15px 8px 0 15px;
		}
		.type-title{
		 display: none;	margin: 60px 0 20px; border: 1px solid #7EB6FF; color: #7EB6FF; height: 44px; line-height: 44px; font-size: 18px; text-align: center;
		}
		
		.select-back {
			position: absolute;
			width: 80px;
			/* line-height: 46px; */
			color: #7EB6FF;
			top: 0;
			left: 5px;
		}
		
		.imgBox {
			width: 96%;
			height: 40vh;
			border: 1px solid #aaaaaa;
			margin: 20px auto;
		}
		
		.imgBox>img {
		    width: 100%;
		    height: 100%;
		}
	</style>
</head>

<body>
	<!-- 装 每个协议的容器 -->
	<div class="ctra-dialog">
		<header class="ctra-header">
		  <!-- <img class="back" src="../../img/back_black.png" alt=""> 慧业通服务平台条款 -->
			<div class="back select-back"> <<返回 </div>
			<span class="title-span">协议详情</span>
		</header>
		<div class="type-title"></div>
		<div class="itemContent">
		
		</div>
		<!-- 图片预览放大的功能 -->
		<!-- <section class="imgzoom_pack">
			<div class="imgzoom_x">X</div>
			<div class="imgzoom_img"><img src="" /></div>
		</section> -->
	</div>
	
	
	
	<header>
			<img class="back" src="../../../img/back_black.png" alt=""> 收入信息
	</header>
	<div class="the-place"></div>
	<ul class="com-ul">
		<div class="info-title">服务项目信息</div>
		<li class="xname">
				<span>项目名称</span>
				<div>
						<span class="xname-li"></span>
				</div>
		</li>
		<li class="descripts">
				<span>服务内容</span>
				<div>
					<span class="descripts-li con-dialog" id="descripts-dialog"></span>
					<img class="nextImg" src="../../../img/next.png" alt="">
				</div>
		</li>
		<li class="zq">
				<span>服务周期</span>
				<div>
						<span class="zq-li"></span>
				</div>
		</li>
		<li class="accptcom">
				<span>付款方名称</span>
				<div>
						<span class="accptcom-li"></span>
				</div>
		</li>
		<li class="fkcode">
				<span>付款账号</span>
				<div>
						<span class="fkcode-li con-dialog" id="fkcode-dialog"></span>
						<img class="nextImg" src="../../../img/next.png" alt="">
				</div>
		</li>
		<li class="com_yz_name">
				<span>收款方商户名</span>
				<div>
						<span class="com_yz_name-li con-dialog" id="com_yz-dialog"></span>
						<img class="nextImg" src="../../../img/next.png" alt="">
				</div>
		</li>
		<li class="yhcard_dg_code">
				<span>收款方账号</span>
				<div>
						<span class="yhcard_dg_code-li"></span>
				</div>
		</li>
		<li class="fkmoney">
				<span>付款金额</span>
				<div>
						<span class="fkmoney-li fwstyle"></span>
				</div>
		</li>
	</ul>
	
	<!-- <div class="ul-title">付款方信息:</div> -->
	<ul class="info-ul">
		<div class="info-title">收款方个人信息</div>
		<li class="yzname">
				<span>收款人</span>
				<div>
						<span class="yzname-li"></span>
				</div>
		</li>
		<li class="skcard">
				<span>收款账号</span>
				<div>
						<span class="skcard-li"></span>
						<!-- <input class="skcard" disabled/> -->
				</div>
		</li>
		<li class="ysmoney">
				<span>税后净收入</span>
				<div>
						<span class="ysmoney-li fwstyle"></span>
				</div>
		</li>
	</ul>
	
	<!-- <div class="ul-title">内容详情:</div> -->
<!-- 	<ul class="deal-ul">
		<div class="info-title">该收入相关协议</div>
		<li class="deal">
				<span>业务合同</span>
				<div>
						<span class="deal-li"></span>
						<img class="nextImg" src="../../../img/next.png" alt="">
				</div>
		</li>
	</ul> -->
	
	<!-- 审核退回时显示 -->
	<div class="returnTitle">退回原因：</div>
	<div class="returnCont">艾斯黛肯就7593245723948573294</div>
</body>
<script src="../../../js/jquery-3.3.1.js"></script>
<script src="../../../js/urlDns.js"></script>
<script src="../../../js/layer/layer.js"></script>

<script type="text/javascript">
	mui.init({
		beforeback: function() {
			if(is_agree){
				backActive()
				return false
			}
			else{ 
				// history.go(-2)
				return true 
			}
		}
	})
	// 返回=======================
	$(".back").click(() => {
		mui.back();
	});
	// 返回之前要执行的操作 函数
	function backActive() {
		// sessionStorage.removeItem("incomeDetailId");
		// sessionStorage.removeItem("income_status");
		if(is_agree) {
			$(".ctra-dialog").css("display","none")
			is_agree = false
		}
	}
		
	// 用户是否处在 条款详情页
	var is_agree = false 
	
	// mui.init({
	// 	beforeback: function() {
	// 		backActive()
	// 		return true
	// 	}
	// })
	// // 返回=======================
	// $(".back").click(() => {
	// 	mui.back();
	// });
	// // 返回之前要执行的操作 函数
	// function backActive() {
	// 	// sessionStorage.removeItem("income_status");
	// }
	
	var pass_app = localStorage.getItem("pass_app");
	var tel_app = localStorage.getItem("tel_app");
	var code_app = localStorage.getItem("code_app");
	
	// 获取进入的状态值
	var income_status = sessionStorage.getItem("income_status")
	if(income_status == 5){
		$(".returnTitle").css("display","block")
		$(".returnCont").css("display","block")
	}
	
	// 获取id
	var detailId = sessionStorage.getItem("detailId");
	
	
	let xy_type   // 协议类型
	let imgs   // 协议内容
	$(function() {
	    var index = layer.load(1, {
	        // 数组中第一个参数是button的透明度
	        // 第二个是背景颜色
	        shade: [0.3, "white"]
	    });
	    var getData = $.ajax({
	        url: urlDns + "/control_app/share/zf/showUI",// /control_app/ms/fr_zg/zf/showUI"
	        type: 'post',
	        dataType: "json",
	        timeout: 120000, //2分钟超时
	        data: {
	            "pass_app": pass_app,
	            "tel_app": tel_app,
	            "code_app": code_app,
							"id": detailId
	        },
	        //请求成功
	        success: function(data) {
	            console.log(JSON.stringify(data));
	            layer.close(index);
	            if (data.result == 0) {
	                // 需要重新登录
	                if (window.plus) {
	                    goToLogin("../../../page/register/login.html");
	                } else {
	                    document.addEventListener('plusready', goToLogin, false);
	                }
	            } 
							else {
								xy_type = data.xy_type
								imgs = data.imgs
								// console.log(JSON.stringify(imgs))
								// $(".accptcom").attr("id", data.ttid);
								
								$(".accptcom-li").text(data.ttname);
								$(".com_yz_name-li").text(data.com_yz_name.name);
								$(".yhcard_dg_code-li").text(data.yhcard_dg_code);
								
								$(".fkcode-li").text(data.fk_code);
								$(".yzname-li").text(data.yzname);
								$(".skcard-li").text(data.yhcard_dg_code);
								
								$(".xname-li").text(data.name);
								$(".descripts-li").text(data.descripts);
								$(".zq-li").text(data.zq);
								$(".fkmoney-li").text('¥ ' + data.fkmoney);
								$(".ysmoney-li").text('¥ ' + data.ysmoney);
								
								if (data.reasons) {
								    $(".returnCont").text(data.reasons);
								}
	            }
	
	        },
	        error: function(XMLHttpRequest, textStatus, errorThrown) {
	            layer.close(index);
	            if (textStatus == 'timeout') {
	                getData.abort();　
	                alert("请求超时");
	            }
	            if (textStatus == 'error') {
	                getData.abort();　
	                alert("请求错误" + errorThrown);
	            }
	        }
	    });
	});
	

	// 点击 付款账号
	$("#fkcode-dialog").click(()=>{
		// 展示详细信息
		mui.alert($("#fkcode-dialog").html(),'详细内容','关闭','','div')
	})
	// 点击 项目内容
	$("#descripts-dialog").click(()=>{
		// 展示详细信息
		mui.alert($("#descripts-dialog").html(),'项目内容','关闭','','div')
	})
	
	// 点击 收款方商户名称
	$("#com_yz-dialog-dialog").click(()=>{
		// 展示详细信息
		mui.alert($("#com_yz-dialog-dialog").html(),'收款方商户名称','关闭','','div')
	})
	
	
	// 点击业务合同===========================
	$(".deal").click(() => {
	  is_agree = true
	  $(".ctra-dialog").css("display","block")
	  // if ($(document.body).height() < $(window).height() - 185) {
	  //     // 减掉的64是除了$(".cont")以外其他元素的高度
	  //     $(".itemContent").css("height", "calc(100vh - 64px)");
	  // }
	  if(xy_type==2) {
	  	$(".itemContent").html(imgs);
	  }
	  else {
	  	let htmlStr = "";
	  	// let img_arr = imgs.split(",")
	  	let len = imgs.length || 0
	  	for (var i = 0; i < len; i++) {
	  			htmlStr += `
	  	<div class="imgBox" style="width: 96%; height: 70vh; border: 1px solid #aaaaaa;	margin: 10px auto;">
	  			<img class="img-crt" src="${imgs[i]}" style="width:100%; height:100%;" alt="">
	  	</div>
	  	`;
	  	}
	  	$(".itemContent").html(htmlStr);
	  }
	});
	
</script>
</html>
