<!DOCTYPE html>
<html lang="">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="../../../js/mui.min.js"></script>
    <link rel="stylesheet" href="../../../css/mui.min.css">
    <title>审核主管: 纳税设置审核</title>
		<script type="text/javascript">
			mui.init();
		</script>
		
		<style type="text/css">
			body {
			    margin: 0;
			    padding: 0;
			    color: #333333;
			}
			
			header {
			    position: fixed;
			    top: 0;
			    left: 0;
			    z-index: 99;
			    text-align: center;
			    line-height: 44px;
			    width: 100%;
			    height: 44px;
			    /* font-weight: bold; */
			    background-color: white;
			    box-shadow: 0 2px 2px 0 rgba(231, 231, 231, 1);
			}
			
			header>img {
			    position: absolute;
			    top: 12px;
			    left: 5px;
			    width: 20px;
			    height: 20px;
			}
			
			header>div {
			    position: absolute;
			    top: 0;
			    right: 5px;
			    height: 44px;
			    line-height: 44px;
			}
			
			.next {
			    line-height: 44px;
			    color: #7EB6FF;
			    margin-right: 10px;
			}
			
			ul {
			    list-style: none;
			    padding: 0;
			    margin: 20px 0 0 0;
			}
			
			li {
			    display: flex;
			    justify-content: space-between;
			    width: 100%;
			    height: 46px;
			    background-color: white;
			    margin-bottom: 2px;
			    line-height: 46px;
			    padding: 0 5px 0 15px;
			    box-sizing: border-box;
			}
			
			li img {
			    width: 25px;
			    height: 25px;
			    vertical-align: middle;
			}
			
			li>div>span {
			    color: rgb(153, 153, 153);
			}
			
			.com-ul,.free-ul{
			    margin-top: 64px;
			}
			
			.free-ul{
			    display: none;
			}
			
			.change{
			    position: absolute;
			    left: calc((100% - 200px)/2);
			    top: 5px;
			    width: 200px;
			    height: 34px;
			    background-color: white;
			    border-radius: 4px;
			    display: flex;
			    border: 1px solid #7EB6FF;
			}
			
			.input_com,.input_free{
			    width: 100px;
			    text-align: center;
			    line-height: 34px;
			
			}
			.input_com{
			    background-color: #7EB6FF;
			    color: white;
			}
			
			.input_free{
			    color: #7EB6FF;
			}
		</style>
</head>

<body>
    <header>
        <img class="back" src="../../../img/back_black.png" alt="">
        <div class="change">
            <div class="input_com">有单位</div>
            <div class="input_free">没有单位</div>
        </div>
    </header>

    <ul class="com-ul">
        <li class="com-normal">
            <span>正常</span>
            <div>
                <span class="com-normal-li"></span>
                <img src="../../../img/next.png" alt="">
            </div>
        </li>
        <li class="com-checking">
            <span>审核中</span>
            <div>
                <span class="com-checking-li"></span>
                <img src="../../../img/next.png" alt="">
            </div>
        </li>
        <li class="com-back">
            <span>审核退回</span>
            <div>
                <span class="com-back-li"></span>
                <img src="../../../img/next.png" alt="">
            </div>
        </li>
        

    </ul>

    <ul class="free-ul">
        <li class="free-normal">
            <span>正常</span>
            <div>
                <span class="free-normal-li"></span>
                <img src="../../../img/next.png" alt="">
            </div>
        </li>
        <li class="free-checking">
            <span>审核中</span>
            <div>
                <span class="free-checking-li"></span>
                <img src="../../../img/next.png" alt="">
            </div>
        </li>
        <li class="free-back">
            <span>审核退回</span>
            <div>
                <span class="free-back-li"></span>
                <img src="../../../img/next.png" alt="">
            </div>
        </li>
        
    </ul>
</body>

<script src="../../../js/jquery-3.3.1.js"></script>
<script src="../../../js/urlDns.js"></script>

<script type="text/javascript">
	// 返回
	$(".back").click(() => {
		sessionStorage.removeItem("addtype");
		sessionStorage.removeItem("income_status");
		history.back();
	});
	var pass_app = localStorage.getItem("pass_app");
	var tel_app = localStorage.getItem("tel_app");
	var code_app = localStorage.getItem("code_app");
	
	
	if (addtype==undefined){
		getInfo(0)   // 初次加载时, 获取页面信息 0:单位录入   1:业者录入
	}   
	
	// 角色切换
	$(".input_com").click(()=>{
	    $(".input_com").css("background-color","#7EB6FF");
	    $(".input_com").css("color","white");
	    $(".input_free").css("background-color","white");
	    $(".input_free").css("color","#7EB6FF");
	    $(".com-ul").css("display","block");
	    $(".free-ul").css("display","none");
			
			getInfo(0) // 重新获取单位录入的 页面数据信息
	})

	$(".input_free").click(()=>{
	    $(".input_free").css("background-color","#7EB6FF");
	    $(".input_free").css("color","white");
	    $(".input_com").css("background-color","white");
	    $(".input_com").css("color","#7EB6FF");
	    $(".free-ul").css("display","block");
	    $(".com-ul").css("display","none");
	
	    getInfo(1) // 重新获取业者录入的 页面数据信息
	})
	
	// 判断下一个 页面返回来是处在 单位录入还是业者录入的界面
	var addtype = sessionStorage.getItem("addtype");
	if (addtype == "sf") {
		$(".input_com").css("background-color","#7EB6FF");
		$(".input_com").css("color","white");
		$(".input_free").css("background-color","white");
		$(".input_free").css("color","#7EB6FF");
		$(".com-ul").css("display","block");
		$(".free-ul").css("display","none");
		getInfo(0)
	}
	if (addtype == "yz") {
		$(".input_free").css("background-color","#7EB6FF");
		$(".input_free").css("color","white");
		$(".input_com").css("background-color","white");
		$(".input_com").css("color","#7EB6FF");
		$(".free-ul").css("display","block");
		$(".com-ul").css("display","none");
		getInfo(1)
	}
	
	
	// 跳转列表
	// 录入方式addtype（业者录入为："yz"    单位录入:"sf"）
	// ========有单位=======
	$(".com-normal").click(() => {
		sessionStorage.setItem("addtype", "sf");
		sessionStorage.setItem("income_status", 1);
		location.href = './tax_list.html';
	});
	
	$(".com-checking").click(() => {
		sessionStorage.setItem("addtype", "sf");
		sessionStorage.setItem("income_status", 2);
		location.href = './tax_list.html';
	});
	
	$(".com-back").click(() => {
		sessionStorage.setItem("addtype", "sf");
		sessionStorage.setItem("income_status", 3);
		location.href = './tax_list.html';
	});
	
	
	// =======没有单位============
	$(".free-normal").click(() => {
		sessionStorage.setItem("addtype", "yz");
		sessionStorage.setItem("income_status", 2);
		location.href = './tax_list.html';
	});
	
	$(".free-checking").click(() => {
		sessionStorage.setItem("addtype", "yz");
		sessionStorage.setItem("income_status", 5);
		location.href = './tax_list.html';
	});
	
	$(".free-back").click(() => {
		sessionStorage.setItem("addtype", "yz");
		sessionStorage.setItem("income_status", 6);
		location.href = './tax_list.html';
	});
	
	
	// 请求数据的函数
	function getInfo(enterType) {
		enterType = enterType.toString()
		
		mui.post(urlDns + "/control_app/ms/fr_zg/zf/index",{
		    // 0.有单位  2.没有单位
		    tel_app:tel_app,
		    pass_app:pass_app,
		    code_app:code_app,
				type: enterType
		},function(data){
		    console.log(JSON.stringify(data))
				if (data.result == 0) {
					// 需要重新登录
					if (window.plus) {
						goToLogin("../../register/login.html");
					} 
					else {
						document.addEventListener('plusready', goToLogin, false);
					}
				} 
				else {
					// 有单位
					if(enterType == '0') {
						$(".com-normal-li").text(data.send);
						$(".com-checking-li").text(data.yz_nopass);
						$(".com-back-li").text(data.yz_pass);
					}
				
					// 没有单位
					if(enterType == '1') {
						$(".free-normal-li").text(data.wait_check);
						$(".free-checking-li").text(data.ms_nopass);
						$(".free-back-li").text(data.ms_pass);
					}
				
				}
		})
	}
</script>

</html>